clear all; close all;

%CT = ncread('thetao_oras4_1m_1958-2015_grid_1x1.mean.nc','thetao');
load an_yi.mat

Z = [ 5.02159 15.07854 25.16046 35.27829 45.44776 55.69149 66.04198 ...
    76.54591 87.27029 98.31118 109.8062 121.9519 135.0285 149.4337 ...
    165.7285 184.6975 207.4254 235.3862 270.5341 315.3741 372.9655 ...
    446.8009 540.5022 657.3229 799.5496 967.9958 1161.806 1378.661 ...
    1615.291 1868.071 2133.517 2408.583 2690.78 2978.166 3269.278 ...
    3563.041 3858.676 4155.628 4453.502 4752.021 5050.99 5350.272 ];

temp = permute(CT,[3 2 1]);

d20 = - ra_isotherm(temp,Z,20);
surf(d20); zlim([-300 -50]);clim([-300 -50]);colorbar
